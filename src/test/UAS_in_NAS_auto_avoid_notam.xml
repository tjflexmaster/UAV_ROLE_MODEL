<team name="Basic UAS in NAS">
  <channels>
    <channel name="DATA_UAV_UAS" type="DATA" source="UAV" target="UAS"/>
    <channel name="VISUAL_UAV_UAVOP" type="VISUAL" source="UAV" target="UAVOP"/>
    <channel name="VISUAL_UAS_UAVOP" type="VISUAL" source="UAS" target="UAVOP"/>
    <channel name="AUDIO_UAS_UAVOP" type="AUDIO" source="UAS" target="UAVOP"/>
    <channel name="TACTILE_UAVOP_UAS" type="TACTILE" source="UAVOP" target="UAS"/>
    <channel name="DATA_UAS_UAV" type="DATA" source="UAS" target="UAV"/>
    <channel name="DATA_UAS_FAA" type="DATA" source="UAS" target="FAA"/>
    <channel name="DATA_FAA_UAS" type="DATA" source="FAA" target="UAS"/>
    <channel name="VISUAL_FAA_ATC" type="VISUAL" source="FAA" target="ATC"/>
    <channel name="TACTILE_ATC_FAA" type="TACTILE" source="ATC" target="FAA"/>
    
    <channel name="DATA_ATC_STATE" type="DATA" source="ATC" target="ATC"/>   
  
    <!-- Event Channels -->
    <channel name="NEW_MISSION" type="EVENT" source="" target="UAVOP" dataType="String"/>
    <channel name="RADAR_COLLISION" type="EVENT" source="" target="UAVOP" dataType="String"/>   
    <channel name="FAA_COLLISION" type="EVENT" source="" target="FAA" dataType="String"/>
    <channel name="NEW_NOTAM" type="EVENT" source="" target="ATC" dataType="String"/>   
    <channel name="END_UAV_COLLISION" type="EVENT" source="" target="FAA" dataType="String"/>
  </channels>
  
  <!-- Model Actors -->
  <actors>
    <!-- ACTOR UAVOP   ////////////////////////////////////////////////////////////-->
    <actor name="UAVOP" showMetrics="true">
      <inputchannels>
        <channel>VISUAL_UAS_UAVOP</channel>
        <channel>AUDIO_UAS_UAVOP</channel>
        <channel>VISUAL_UAV_UAVOP</channel>
        <channel>NEW_MISSION</channel>
      </inputchannels>
      <outputchannels>
        <channel>TACTILE_UAVOP_UAS</channel>
      </outputchannels>
      
      <!-- Define actor memory -->
      <memory name="FAA_APPROVED" dataType="Boolean">false</memory>
      <memory name="FLIGHT_PLAN_READY" dataType="Boolean">false</memory>
<!--      <memory name="CHANGED_FLIGHT_PLAN" dataType="Boolean">true</memory-->
      <memory name="FLIGHT_STATE" dataType="String">NONE</memory>
      
      
      <!-- Start state -->
      <startState>IDLE</startState>
      
      <!-- States -->
      <states>
        <state name="IDLE" load="0">
          <!-- transitions -->
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Received new mission, begin building flight plan.</description>
            <inputs>
              <channel name="NEW_MISSION" predicate="eq">NEW_MISSION</channel>
            </inputs>
            <outputs>
              <channel name="NEW_MISSION"><null/></channel>
            </outputs>
            <endState>BUILD_FP</endState>
          </transition>
        </state>
        
        <state name="BUILD_FP" load="2">
          <!-- transitions -->
          <transition durationMin="900" durationMax="1200" priority="10">
            <description>Build a flight plan</description>
            <inputs>
              <memory name="FLIGHT_PLAN_READY" predicate="eq">false</memory>
              <channel name="VISUAL_UAS_UAVOP" predicate="ne">BLAH</channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE" dataType="String">FLIGHT_PLAN</layer>
                <layer name="KEYBOARD" dataType="String">FLIGHT_PLAN</layer>
              </channel>
              <memory name="FLIGHT_PLAN_READY" dataType="Boolean">true</memory>
            </outputs>
            <endState>BUILD_FP</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Click the Send flight plan button</description>
            <inputs>
              <memory name="FLIGHT_PLAN_READY" predicate="eq">true</memory>
              <memory name="FAA_APPROVED" predicate="eq">false</memory>
              <channel name="VISUAL_UAS_UAVOP" predicate="ne">BLAH</channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE" dataType="String">SEND_FLIGHT_PLAN</layer>
              </channel>
            </outputs>
            <endState>END_BUILD_FP</endState>
          </transition>
        </state>
        
        <state name="END_BUILD_FP" load="0">
          <transition durationMin="1" durationMax="1" priority="1">
            <description>Clear mouse and keyboard output layers</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE"><null/></layer>
                <layer name="KEYBOARD"><null/></layer>
              </channel>
            </outputs>
            <endState>WAITING_ON_FAA</endState>
          </transition>
        </state>
        
        <state name="WAITING_ON_FAA" load="1">
          
          <transition durationMin="30" durationMax="60" priority="10">
            <description>FAA approved the flight</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="FLIGHT_PLAN" predicate="eq">FLIGHT_PLAN_APPROVED</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE">TAKEOFF</layer>
              </channel>
              <memory name="FAA_APPROVED" dataType="Boolean">true</memory>
            </outputs>
            <endState>END_WAITING_ON_FAA</endState>
          </transition>
          
        </state>
        
        <state name="END_WAITING_ON_FAA" load="0">
          <transition durationMin="1" durationMax="1" priority="1">
            <description>Clear user output</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE"><null/></layer>
              </channel>
            </outputs>
            <endState>MONITOR_TAKEOFF</endState>
          </transition>
        </state>
        
        <state name="MONITOR_TAKEOFF" load="1">
          <transition durationMin="1" durationMax="1" priority="1">
            <description>UAV is airborne, move to monitor GUI</description>
            <inputs>
              <channel name="VISUAL_UAV_UAVOP" predicate="eq">FLYING</channel>
            </inputs>
            <outputs>
              <memory name="FLIGHT_STATE">NORMAL</memory>
            </outputs>
            <endState>MONITOR_UAVGUI</endState>
          </transition>
        </state>
        
        <state name="MONITOR_UAVGUI" load="1">
          <transition durationMin="900" durationMax="900" priority="0">
            <description>Monitoring the UAVGUI</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV" predicate="eq">FLYING</layer>
                <layer name="RADAR" predicate="ne">COLLISION</layer>
                <layer name="EMERGENCY_NOTAM" predicate="ne">EMERGENCY_NOTAM</layer>
                <layer name="NEW_NOTAM_ON_FLIGHT_PATH" predicate="ne">NEW_NOTAM_ON_FLIGHT_PATH</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE">MONITORING_UAVGUI</layer>
              </channel>
            </outputs>
            <endState>MONITOR_UAVGUI</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Operator sees that the UAV is beginning the landing approach</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV" predicate="eq">LANDING</layer>
              </channel>
            </inputs>
            <outputs>
              
            </outputs>
            <endState>MONITOR_LANDING</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="20">
            <description>Operator sees a potential conflict and trys to avoid it</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="RADAR" predicate="eq">COLLISION</layer>
              </channel>
            </inputs>
            <outputs></outputs>
            <endState>AVOID_COLLISION</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="19">
            <description>Operator notices an emergency notam on the UAV and attempts to assist</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="EMERGENCY_NOTAM" predicate="eq">EMERGENCY_NOTAM</layer>
              </channel>
            </inputs>
            <outputs>
              <memory name="FLIGHT_STATE">EMERGENCY_NOTAM</memory>
            </outputs>
            <endState>AVOID_EMERGENCY_NOTAM</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="18">
            <description>Operator notices that the UAV is avoiding a NOTAM and attempts to assist</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV" predicate="eq">AVOID_NOTAM</layer>
              </channel>
            </inputs>
            <outputs>
              <memory name="FLIGHT_STATE">EMERGENCY_NOTAM</memory>           
            </outputs>
            <endState>AVOID_EMERGENCY_NOTAM</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="15">
            <description>Operator notices new NOTAM(s) on the flight plan, begin changing the flight plan.</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="NEW_NOTAM_ON_FLIGHT_PATH" predicate="eq">NEW_NOTAM_ON_FLIGHT_PATH</layer>
              </channel>
              <memory name="FLIGHT_STATE" predicate="eq">NORMAL</memory>
            </inputs>
            <outputs>
              <memory name="FLIGHT_STATE">NEW_NOTAMS</memory>
            </outputs>
            <endState>AVOID_NOTAM</endState>
          </transition>
        </state>
                                                           
        <state name="MONITOR_LANDING" load="1">
          <transition durationMin="30" durationMax="60" priority="10">
            <description>Operator sees that the UAV has landed and sets the mission to complete.</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV" predicate="eq">GROUNDED</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="KEYBOARD">MISSION_COMPLETE</layer>
                <layer name="MOUSE">MISSION_COMPLETE</layer>
              </channel>
            </outputs>
            <endState>IDLE</endState>
          </transition>
        </state>
        
        <state name="AVOID_COLLISION" load="2">
          <transition durationMin="300" durationMax="600" priority="100">
            <description>Operator is in the act of deconflicing the UAV</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="RADAR" predicate="eq">COLLISION</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="KEYBOARD">AVOID_COLLISION</layer>
                <layer name="MOUSE">AVOID_COLLISION</layer>
              </channel>
            </outputs>
            <endState>AVOID_COLLISION</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Collision has been avoided, return to watching the UAVGUI</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="RADAR" predicate="ne">COLLISION</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>
            </outputs>
            <endState>MONITOR_UAVGUI</endState>
          </transition>
        </state>
        
        <state name="AVOID_EMERGENCY_NOTAM" load="1">
          <transition durationMin="300" durationMax="300" priority="1">
            <description>Operator is waiting for the UAV to auto remove itself from the Emergency Notam</description>
            <inputs>
<!--              <channel name="VISUAL_UAS_UAVOP">-->
<!--                <layer name="EMERGENCY_NOTAM" predicate="eq">EMERGENCY_NOTAM</layer>-->
<!--                <layer name="UAV" predicate="ne">LOITER</layer>-->
<!--              </channel>-->
<!--              <memory name="FLIGHT_STATE" predicate="eq">EMERGENCY_NOTAM</memory>-->
            </inputs>
            <outputs>
              <!-- DO Nothing the UAV will fix itself, then we will continue -->
<!--              <channel name="TACTILE_UAVOP_UAS">-->
<!--                <layer name="KEYBOARD">CHANGE_FLIGHT_PLAN</layer>-->
<!--                <layer name="MOUSE">CHANGE_FLIGHT_PLAN</layer>-->
<!--              </channel>-->
<!--              <memory name="CHANGED_FLIGHT_PLAN">true</memory>-->
            </outputs>
            <endState>AVOID_EMERGENCY_NOTAM</endState>
          </transition>
          
          <transition durationMin="5" durationMax="5" priority="100">
            <description>Operator sees that the UAV is loitering, have it resume flight now.</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="EMERGENCY_NOTAM" predicate="ne">EMERGENCY_NOTAM</layer>
                <layer name="UAV" predicate="eq">LOITER</layer>
              </channel>
              <memory name="FLIGHT_STATE" predicate="eq">EMERGENCY_NOTAM</memory>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="KEYBOARD">RESUME_FLIGHT</layer>
                <layer name="MOUSE">RESUME_FLIGHT</layer>
              </channel>
              <memory name="FLIGHT_STATE">NORMAL</memory>
            </outputs>
            <endState>AVOID_EMERGENCY_NOTAM</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>NOTAM has been avoided, return to watching the UAVGUI</description>
            <inputs>
              <memory name="FLIGHT_STATE" predicate="eq">NORMAL</memory>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>
            </outputs>
            <endState>MONITOR_UAVGUI</endState>
          </transition>
        </state>
        
        <state name="AVOID_NOTAM" load="1">
          <transition durationMin="600" durationMax="1200" priority="10">
            <description>Operator is changing the flight plan for a normal NOTAM</description>
            <inputs>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="NEW_NOTAM_ON_FLIGHT_PATH" predicate="eq">NEW_NOTAM_ON_FLIGHT_PATH</layer>
              </channel>
              <memory name="FLIGHT_STATE" predicate="eq">NEW_NOTAMS</memory>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="KEYBOARD">CHANGE_FLIGHT_PLAN</layer>
                <layer name="MOUSE">CHANGE_FLIGHT_PLAN</layer>
              </channel>
              <memory name="FLIGHT_STATE">NORMAL</memory>
            </outputs>
            <endState>AVOID_NOTAM</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>NOTAM has been avoided, return to watching the UAVGUI</description>
            <inputs>
              <memory name="FLIGHT_STATE" predicate="eq">NORMAL</memory>
            </inputs>
            <outputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>
            </outputs>
            <endState>MONITOR_UAVGUI</endState>
          </transition>
          
        </state>
                                   
      </states>
    </actor>
    
    
    <!-- Actor UAS ///////////////////////////////////////////////////////////-->
    <actor name="UAS">
      <inputchannels>
        <channel>TACTILE_UAVOP_UAS</channel>
        <channel>DATA_FAA_UAS</channel>
        <channel>DATA_UAV_UAS</channel>
        <channel>RADAR_COLLISION</channel>
      </inputchannels>
      <outputchannels>
        <channel>VISUAL_UAS_UAVOP</channel>
        <channel>AUDIO_UAS_UAVOP</channel>
        <channel>DATA_UAS_FAA</channel>
        <channel>DATA_UAS_UAV</channel>
      </outputchannels>
      
      <!-- Define actor memory -->
      <memory name="FLIGHT_PLAN" dataType="String">NONE</memory>     
      <memory name="UAV" dataType="String">NONE</memory>
      <memory name="RADAR" dataType="String">NONE</memory>
      <memory name="EMERGENCY_NOTAM" dataType="String">NONE</memory>
      <memory name="NEW_NOTAM_ON_FLIGHT_PATH" dataType="String">NONE</memory>
      
      <!-- Start state -->
      <startState>NORMAL</startState>
      
      <!-- States -->
      <states>
        <state name="NORMAL" load="0">
          <!-- transitions -->
          <!-- START UAVOp Input transitions -->
          <transition durationMin="1" durationMax="1" priority="1">
            <description>Send flight plan to FAA</description>
            <inputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE" predicate="eq">SEND_FLIGHT_PLAN</layer>
              </channel>
            </inputs>
            <outputs>
              <memory name="FLIGHT_PLAN">SEND_FLIGHT_PLAN</memory>
              <channel name="DATA_UAS_FAA">
                <layer name="FLIGHT_PLAN">SEND_FLIGHT_PLAN</layer>
              </channel>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="FLIGHT_PLAN"><memory name="FLIGHT_PLAN"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
 
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAVOP sent take off command</description>
            <inputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE" predicate="eq">TAKEOFF</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="DATA_UAS_UAV">TAKEOFF</channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAVOP sent resume flight</description>
            <inputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE" predicate="eq">RESUME_FLIGHT</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="DATA_UAS_UAV">RESUME_FLIGHT</channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAVOP sent a new flight</description>
            <inputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE" predicate="eq">CHANGE_FLIGHT_PLAN</layer>
              </channel>
            </inputs>
            <outputs>
              <memory name="NEW_NOTAM_ON_FLIGHT_PATH"><null/></memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="NEW_NOTAM_ON_FLIGHT_PATH"><memory name="NEW_NOTAM_ON_FLIGHT_PATH"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
<!-- END UAVOP input TRANSITIONS -->
          
<!-- START FAA input TRANSITIONS -->
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Received flight plan approved from FAA</description>
            <inputs>
              <channel name="DATA_FAA_UAS">
                <layer name="FLIGHT_PLAN_RESPONSE" predicate="eq">FLIGHT_PLAN_APPROVED</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="DATA_FAA_UAS">
                <layer name="FLIGHT_PLAN_RESPONSE"><null/></layer>
              </channel>
              <memory name="FLIGHT_PLAN">FLIGHT_PLAN_APPROVED</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="FLIGHT_PLAN"><memory name="FLIGHT_PLAN"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Receive Emergency Notam on the UAV, force UAV away from NOTAM</description>
            <inputs>
              <channel name="DATA_FAA_UAS">
                <layer name="EMERGENCY_NOTAM" predicate="eq">EMERGENCY_NOTAM</layer>
              </channel>
              <memory name="EMERGENCY_NOTAM" predicate="ne">EMERGENCY_NOTAM</memory>
            </inputs>
            <outputs>
              <memory name="EMERGENCY_NOTAM">EMERGENCY_NOTAM</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="EMERGENCY_NOTAM"><memory name="EMERGENCY_NOTAM"/></layer>
              </channel>
              <channel name="DATA_UAS_UAV">AVOID_NOTAM</channel>
              <channel name="DATA_FAA_UAS">
                <layer name="EMERGENCY_NOTAM"><null/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Receive new NOTAM from FAA which appears on the Flight Plan</description>
            <inputs>
              <channel name="DATA_FAA_UAS">
                <layer name="NEW_NOTAM" predicate="eq">NEW_NOTAM</layer>
              </channel>
            </inputs>
            <outputs>
              <memory name="NEW_NOTAM_ON_FLIGHT_PATH">NEW_NOTAM_ON_FLIGHT_PATH</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="NEW_NOTAM_ON_FLIGHT_PATH"><memory name="NEW_NOTAM_ON_FLIGHT_PATH"/></layer>
              </channel>
              <channel name="DATA_FAA_UAS">
                <layer name="NEW_NOTAM"><null/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          <!-- END FAA input TRANSITIONS -->         
                     
          <!--  START UAV STATE TRANSITIONS -->
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAV has started to takeoff, show this to the UAVOp</description>
            <inputs>
              <memory name="UAV" predicate="ne">TAKEOFF</memory>
              <channel name="DATA_UAV_UAS" predicate="eq">TAKEOFF</channel>
            </inputs>
            <outputs>
              <memory name="UAV">TAKEOFF</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV"><memory name="UAV"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAV has started to fly, show this to the UAVOp</description>
            <inputs>
              <memory name="UAV" predicate="ne">FLYING</memory>
              <channel name="DATA_UAV_UAS" predicate="eq">FLYING</channel>
            </inputs>
            <outputs>
              <memory name="UAV">FLYING</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV"><memory name="UAV"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAV has started to land, show this to the UAVOp</description>
            <inputs>
              <memory name="UAV" predicate="ne">LANDING</memory>
              <channel name="DATA_UAV_UAS" predicate="eq">LANDING</channel>
            </inputs>
            <outputs>
              <memory name="UAV">LANDING</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV"><memory name="UAV"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAV is GROUNDED, show this to the UAVOp</description>
            <inputs>
              <memory name="UAV" predicate="ne">GROUNDED</memory>
              <channel name="DATA_UAV_UAS" predicate="eq">GROUNDED</channel>
            </inputs>
            <outputs>
              <memory name="UAV">GROUNDED</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV"><memory name="UAV"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAV is avoiding a NOTAM, show this to the UAVOp</description>
            <inputs>
              <memory name="UAV" predicate="ne">AVOID_NOTAM</memory>
              <channel name="DATA_UAV_UAS" predicate="eq">AVOID_NOTAM</channel>
            </inputs>
            <outputs>
              <memory name="UAV">AVOID_NOTAM</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV"><memory name="UAV"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAV is now Loitering, show this to the UAVOp</description>
            <inputs>
              <memory name="UAV" predicate="ne">LOITER</memory>
              <channel name="DATA_UAV_UAS" predicate="eq">LOITER</channel>
            </inputs>
            <outputs>
              <memory name="UAV">LOITER</memory>
              <memory name="EMERGENCY_NOTAM">NONE</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="UAV"><memory name="UAV"/></layer>
                <layer name="EMERGENCY_NOTAM"><memory name="EMERGENCY_NOTAM"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          <!--  END UAV STATE TRANSITIONS -->
          
          <!-- RADAR COLLISION TRANSITIONS -->
          <transition durationMin="1" durationMax="1" priority="100">
            <description>UAS received radar collision event</description>
            <inputs>
              <channel name="RADAR_COLLISION" predicate="eq">RADAR_COLLISION</channel>
              <memory name="RADAR" predicate="ne">COLLISION</memory>
            </inputs>
            <outputs>
              <memory name="RADAR">COLLISION</memory>
              <channel name="RADAR_COLLISION"><null/></channel>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="RADAR"><memory name="RADAR"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="11">
            <description>Radar collision has been avoided</description>
            <inputs>
              <channel name="TACTILE_UAVOP_UAS">
                <layer name="MOUSE" predicate="eq">AVOID_COLLISION</layer>
              </channel>
            </inputs>
            <outputs>
              <memory name="RADAR">NONE</memory>
              <channel name="VISUAL_UAS_UAVOP">
                <layer name="RADAR"><memory name="RADAR"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
 
          <!-- END RADAR COLLISION TRANSITIONS -->

        </state>
        
      </states>
    </actor>
    
    <!-- Actor UAV //////////////////////////////////////////////////////-->
    <actor name="UAV">
      <inputchannels>
        <channel>DATA_UAS_UAV</channel>
      </inputchannels>
      <outputchannels>
        <channel>DATA_UAV_UAS</channel>
        <channel>VISUAL_UAV_UAVOP</channel>
      </outputchannels>
      
      <!-- Define actor memory -->
      
      <!-- Start state -->
      <startState>GROUNDED</startState>
      
      <!-- States -->
      <states>
        <state name="GROUNDED" load="0">
          <!-- transitions -->
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Move to takeoff from UAVGUI cmd</description>
            <inputs>
              <channel name="DATA_UAS_UAV" predicate="eq">TAKEOFF</channel>
            </inputs>
            <outputs>
              <channel name="VISUAL_UAV_UAVOP">TAKEOFF</channel>
              <channel name="DATA_UAV_UAS">TAKEOFF</channel>
              <channel name="DATA_UAS_UAV"><null/></channel>
            </outputs>
            <endState>TAKEOFF</endState>
          </transition>
        </state>
        
        <state name="TAKEOFF" load="0">
          <!-- transitions -->
          <transition durationMin="300" durationMax="600" priority="10">
            <description>Automatic Transition to Flying</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="VISUAL_UAV_UAVOP">FLYING</channel>
              <channel name="DATA_UAV_UAS">FLYING</channel>
            </outputs>
            <endState>FLYING</endState>
          </transition>
        </state>
        
        <state name="FLYING" load="0">
          <!-- transitions -->
          <transition durationMin="10000" durationMax="20000" priority="1">
            <description>UAV normal flight</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="VISUAL_UAV_UAVOP">LANDING</channel>
              <channel name="DATA_UAV_UAS">LANDING</channel>
            </outputs>
            <endState>LANDING</endState>
          </transition>
          
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>UAV gets a command to avoid a NOTAM</description>
            <inputs>
              <channel name="DATA_UAS_UAV" predicate="eq">AVOID_NOTAM</channel>
            </inputs>
            <outputs>
              <channel name="DATA_UAS_UAV"><null/></channel>
              <channel name="DATA_UAV_UAS">AVOID_NOTAM</channel>
            </outputs>
            <endState>AVOID_NOTAM</endState>
          </transition>
          
        </state>
        
        <state name="AVOID_NOTAM" load="0">
          <!-- transitions -->
          <transition durationMin="300" durationMax="600" priority="10">
            <description>Avoid the Emergency NOTAM</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="DATA_UAV_UAS">LOITER</channel>
            </outputs>
            <endState>LOITER</endState>
          </transition>
        </state>
        
        <state name="LOITER" load="0">
          <!-- transitions -->
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Resume a normal flight</description>
            <inputs>
              <channel name="DATA_UAS_UAV" predicate="eq">RESUME_FLIGHT</channel>
            </inputs>
            <outputs>
              <channel name="DATA_UAS_UAV"><null/></channel>
              <channel name="DATA_UAV_UAS">FLYING</channel>
            </outputs>
            <endState>FLYING</endState>
          </transition>
          
          <transition durationMin="10000" durationMax="10000" priority="10">
            <description>Default to land after loitering for a long time.</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="DATA_UAV_UAS">LANDING</channel>
            </outputs>
            <endState>LANDING</endState>
          </transition>
        </state>
        
        <state name="LANDING" load="0">
          <!-- transitions -->
          <transition durationMin="600" durationMax="900" priority="10">
            <description>Land the UAV</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="VISUAL_UAV_UAVOP">GROUNDED</channel>
              <channel name="DATA_UAV_UAS">GROUNDED</channel>
            </outputs>
            <endState>GROUNDED</endState>
          </transition>
        </state>
      </states>
    </actor>
    
    <!-- Actor FAA ///////////////////////////////////////////////////////////-->
    <actor name="FAA">
      <inputchannels>
        <channel>DATA_UAS_FAA</channel>
        <channel>TACTILE_ATC_FAA</channel>
        <channel>FAA_COLLISION</channel>
        <channel>END_UAV_COLLISION</channel>
      </inputchannels>
      <outputchannels>
        <channel>DATA_FAA_UAS</channel>
        <channel>VISUAL_FAA_ATC</channel>
      </outputchannels>
      
      <!-- Define actor memory -->
      <memory name="FLIGHT_PLAN_APPROVALS" dataType="Integer">0</memory>
      <memory name="RADAR" dataType="String">NONE</memory>
      <memory name="EMERGENCY_NOTAM" dataType="String">NONE</memory>
      <memory name="NEW_NOTAM" dataType="String">NONE</memory>
      
      <!-- Start state -->
      <startState>NORMAL</startState>
      
      <!-- States -->
      <states>
        <state name="NORMAL" load="0">
          <!-- transitions -->
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Received Flight plan from UAS</description>
            <inputs>
              <channel name="DATA_UAS_FAA">
                <layer name="FLIGHT_PLAN" predicate="eq">SEND_FLIGHT_PLAN</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="DATA_UAS_FAA">
                <layer name="FLIGHT_PLAN"><null/></layer>
              </channel>
              <!--
              <channel name="DATA_FAA_UAS">
                <layer name="FLIGHT_PLAN_RESPONSE">FLIGHT_PLAN_APPROVED</layer>
              </channel>
              -->
              <memory name="FLIGHT_PLAN_APPROVALS" action="+">1</memory>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS"><memory name="FLIGHT_PLAN_APPROVALS"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>FAA received approved flight plan from ATC, send to UAS</description>
            <inputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="MOUSE" predicate="eq">FLIGHT_PLAN_APPROVED</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="DATA_FAA_UAS">
                <layer name="FLIGHT_PLAN_RESPONSE">FLIGHT_PLAN_APPROVED</layer>
              </channel>
              <memory name="FLIGHT_PLAN_APPROVALS" action="-">1</memory>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS"><memory name="FLIGHT_PLAN_APPROVALS"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <!-- TODO: handle flight plan denial -->
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>Potential collision on FAA Radar, show the user</description>
            <inputs>
              <channel name="FAA_COLLISION" predicate="eq">COLLISION</channel>
              <memory name="RADAR" dataType="String" predicate="ne">COLLISION</memory>
            </inputs>
            <outputs>
              <memory name="RADAR">COLLISION</memory>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS"><memory name="FLIGHT_PLAN_APPROVALS"/></layer>
                <layer name="RADAR"><memory name="RADAR"/></layer>
                <layer name="EMERGENCY_NOTAM"><memory name="EMERGENCY_NOTAM"/></layer>
                <layer name="NEW_NOTAM"><memory name="NEW_NOTAM"/></layer>
              </channel>
              <channel name="FAA_COLLISION"><null/></channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="20">
            <description>ATC sent an Emergency NOTAM to the FAA system, send it to the UAS</description>
            <inputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="MOUSE" predicate="eq">EMERGENCY_NOTAM</layer>
              </channel>
              <memory name="EMERGENCY_NOTAM" predicate="ne">EMERGENCY_NOTAM</memory>
            </inputs>
            <outputs>
              <memory name="EMERGENCY_NOTAM">EMERGENCY_NOTAM</memory>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS"><memory name="FLIGHT_PLAN_APPROVALS"/></layer>
                <layer name="RADAR"><memory name="RADAR"/></layer>
                <layer name="EMERGENCY_NOTAM"><memory name="EMERGENCY_NOTAM"/></layer>
                <layer name="NEW_NOTAM"><memory name="NEW_NOTAM"/></layer>
              </channel>
              <channel name="DATA_FAA_UAS">
                <layer name="EMERGENCY_NOTAM">EMERGENCY_NOTAM</layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="20">
            <description>Radar collision has ended.</description>
            <inputs>
              <channel name="END_UAV_COLLISION" predicate="eq">END_UAV_COLLISION</channel>
              <memory name="RADAR" predicate="eq">COLLISION</memory>
            </inputs>
            <outputs>
              <memory name="EMERGENCY_NOTAM"><null/></memory>
              <memory name="RADAR"><null/></memory>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS"><memory name="FLIGHT_PLAN_APPROVALS"/></layer>
                <layer name="RADAR"><memory name="RADAR"/></layer>
                <layer name="EMERGENCY_NOTAM"><memory name="EMERGENCY_NOTAM"/></layer>
                <layer name="NEW_NOTAM"><memory name="NEW_NOTAM"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <!-- NEW_NOTAM transitions -->
          <transition durationMin="1" durationMax="1" priority="1">
            <description>FAA received new NOTAM on UAV FP from ATC, send to UAS</description>
            <inputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="MOUSE" predicate="eq">NEW_NOTAM</layer>
              </channel>
              <memory name="NEW_NOTAM" predicate="ne">NEW_NOTAM</memory>
            </inputs>
            <outputs>
              <memory name="NEW_NOTAM">NEW_NOTAM</memory>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS"><memory name="FLIGHT_PLAN_APPROVALS"/></layer>
                <layer name="RADAR"><memory name="RADAR"/></layer>
                <layer name="EMERGENCY_NOTAM"><memory name="EMERGENCY_NOTAM"/></layer>
                <layer name="NEW_NOTAM"><memory name="NEW_NOTAM"/></layer>
              </channel>
              <channel name="DATA_FAA_UAS">
                <layer name="NEW_NOTAM">NEW_NOTAM</layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="1">
            <description>Clear New NOTAM memory</description>
            <inputs>
              <memory name="NEW_NOTAM" predicate="eq">NEW_NOTAM</memory>
            </inputs>
            <outputs>
              <memory name="NEW_NOTAM"><null/></memory>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS"><memory name="FLIGHT_PLAN_APPROVALS"/></layer>
                <layer name="RADAR"><memory name="RADAR"/></layer>
                <layer name="EMERGENCY_NOTAM"><memory name="EMERGENCY_NOTAM"/></layer>
                <layer name="NEW_NOTAM"><memory name="NEW_NOTAM"/></layer>
              </channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
        </state>
        
      </states>
    </actor>
    
    <!-- ACTOR /////////////////////////////////////////////////////////////////////-->
    <actor name="ATC" showMetrics="true">
      <inputchannels>
        <channel>VISUAL_FAA_ATC</channel>
        <channel>NEW_NOTAM</channel>
      </inputchannels>
      <outputchannels>
        <channel>TACTILE_ATC_FAA</channel>
        <channel>DATA_ATC_STATE</channel>
      </outputchannels>
      
      <!-- Define actor memory -->
      <memory name="RADAR" dataType="String">NONE</memory>
      <memory name="NEW_NOTAM" dataType="Boolean">false</memory>
      
      <!-- Start state -->
      <startState>NORMAL</startState>
      
      <!-- States -->
      <states>
        <state name="NORMAL" load="1">
          <!-- transitions -->
          <transition durationMin="1" durationMax="1" priority="5">
            <description>ATC is ready to approve flight plans.</description>
            <inputs>
              <channel name="VISUAL_FAA_ATC">
                <layer name="FLIGHT_PLAN_APPROVALS" predicate="gt">0</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="DATA_ATC_STATE">APPROVING_FLIGHT_PLAN</channel>
            </outputs>
            <endState>APPROVING_FLIGHT_PLAN</endState>
          </transition>
 
          <transition durationMin="1" durationMax="1" priority="10">
            <description>ATC sees the alert about a UAV collision and tries to avoid it</description>
            <inputs>
              <channel name="VISUAL_FAA_ATC">
                <layer name="RADAR" predicate="eq">COLLISION</layer>
              </channel>
              <memory name="RADAR" predicate="ne">COLLISION</memory>
            </inputs>
            <outputs>
              <memory name="RADAR">COLLISION</memory>
              <channel name="DATA_ATC_STATE">CREATE_EMERGENCY_NOTAM</channel>
            </outputs>
            <endState>CREATE_EMERGENCY_NOTAM</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="1">
            <description>ATC needs to create a new NOTAM</description>
            <inputs>
              <channel name="NEW_NOTAM" predicate="eq">NEW_NOTAM</channel>
              <memory name="NEW_NOTAM" predicate="eq">false</memory>
            </inputs>
            <outputs>
              <memory name="NEW_NOTAM">true</memory>
            </outputs>
            <endState>CREATE_NOTAM</endState>
          </transition>
        </state>
        
        <state name="APPROVING_FLIGHT_PLAN" load="1">
          <transition durationMin="200" durationMax="400" priority="10">
            <description>ATC is approving flight plans.</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD">FLIGHT_PLAN_APPROVED</layer>
                <layer name="MOUSE">FLIGHT_PLAN_APPROVED</layer>
              </channel>
              <channel name="DATA_ATC_STATE">END_APPROVING_FLIGHT_PLAN</channel>
            </outputs>
            <endState>END_APPROVING_FLIGHT_PLAN</endState>
          </transition>
        </state>
        
        <state name="END_APPROVING_FLIGHT_PLAN" load="0">
          <transition durationMin="1" durationMax="1" priority="1">
            <description>ATC finished approving the flight plan.</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>
              <channel name="DATA_ATC_STATE">NORMAL</channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
        </state>
        
        <state name="CREATE_EMERGENCY_NOTAM" load="2">
          <transition durationMin="60" durationMax="120" priority="100">
            <description>ATC is creating an Emergency Notam around the collision</description>
            <inputs>
              <memory name="RADAR" predicate="eq">COLLISION</memory>
            </inputs>
            <outputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD">EMERGENCY_NOTAM</layer>
                <layer name="MOUSE">EMERGENCY_NOTAM</layer>
              </channel>
              <channel name="DATA_ATC_STATE">END_CREATE_EMERGENCY_NOTAM</channel>
            </outputs>
            <endState>END_CREATE_EMERGENCY_NOTAM</endState>
          </transition>
        </state>
        
        <state name="END_CREATE_EMERGENCY_NOTAM" load="0">
          <transition durationMin="1" durationMax="1" priority="10">
            <description>ATC is creating an Emergency Notam around the collision</description>
            <inputs>
            </inputs>
            <outputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>
              <channel name="DATA_ATC_STATE">AVOID_UAV_COLLISION</channel>
            </outputs>
            <endState>AVOID_UAV_COLLISION</endState>
          </transition>
        </state>
        
        <state name="AVOID_UAV_COLLISION" load="2">
          <transition durationMin="500" durationMax="600" priority="0">
            <description>ATC is waiting for collision to stop.</description>
            <inputs>
              <channel name="VISUAL_FAA_ATC">
                <layer name="RADAR" predicate="eq">COLLISION</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="MOUSE">MONITOR_RADAR</layer>
              </channel>
            </outputs>
            <endState>AVOID_UAV_COLLISION</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="10">
            <description>FAA radar no longer shows a potential collision</description>
            <inputs>
              <channel name="VISUAL_FAA_ATC">
                <layer name="RADAR" predicate="ne">COLLISION</layer>
              </channel>
            </inputs>
            <outputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>
              <channel name="DATA_ATC_STATE">NORMAL</channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
        </state>
        
        <state name="CREATE_NOTAM" load="1">
          <transition durationMin="60" durationMax="120" priority="10">
            <description>ATC is creating a new NOTAM</description>
            <inputs>
              <memory name="NEW_NOTAM" predicate="eq">true</memory>
            </inputs>
            <outputs>
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD">NEW_NOTAM</layer>
                <layer name="MOUSE">NEW_NOTAM</layer>
              </channel>
              <channel name="DATA_ATC_STATE">END_CREATE_NOTAM</channel>
            </outputs>
            <endState>END_CREATE_NOTAM</endState>
          </transition>
          
          <transition durationMin="1" durationMax="1" priority="100">
            <description>ATC sees the alert about a UAV collision and tries to avoid it</description>
            <inputs>
              <channel name="VISUAL_FAA_ATC">
                <layer name="RADAR" predicate="eq">COLLISION</layer>
              </channel>
              <memory name="RADAR" predicate="ne">COLLISION</memory>
            </inputs>
            <outputs>
              <memory name="RADAR">COLLISION</memory>
              <memory name="NEW_NOTAM">false</memory> <!-- This way the ATC will know to return to this state -->
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>             
              <channel name="DATA_ATC_STATE">CREATE_EMERGENCY_NOTAM</channel>
            </outputs>
            <endState>CREATE_EMERGENCY_NOTAM</endState>
          </transition>
        </state>
        
        <state name="END_CREATE_NOTAM" load="0">
          <transition durationMin="1" durationMax="1" priority="1">
            <description>ATC finished creating NOTAM return to normal</description>
            <inputs>
            </inputs>
            <outputs>
              <memory name="NEW_NOTAM">false</memory>
              <channel name="TACTILE_ATC_FAA">
                <layer name="KEYBOARD"><null/></layer>
                <layer name="MOUSE"><null/></layer>
              </channel>
              <channel name="DATA_ATC_STATE">NORMAL</channel>
              <channel name="NEW_NOTAM"><null/></channel>
            </outputs>
            <endState>NORMAL</endState>
          </transition>
        </state>
      </states>
    </actor>
  </actors>
  
  <!-- System Events -->
  <events>
    <event name="NEW_MISSION" count="1">
      <transition>
        <description> Start a new UAV mission</description>
        <inputs>
        </inputs>
        <outputs>
          <channel name="NEW_MISSION">NEW_MISSION</channel>
        </outputs>
      </transition>
    </event>
    
    <event name="RADAR_COLLISION" count="1">
      <transition>
        <description>Potential collision on UAS radar</description>
        <inputs>
          <channel name="DATA_UAV_UAS" predicate="eq">FLYING</channel>
          <channel name="RADAR_COLLISION" predicate="ne">RADAR_COLLISION</channel>
        </inputs>
        <outputs>
          <channel name="RADAR_COLLISION">RADAR_COLLISION</channel>
        </outputs>
      </transition>
    </event>
    
    <event name="FAA_COLLISION" count="1">
      <transition>
        <description>FAA radar shows a potential collision with a UAV</description>
        <inputs>
          <channel name="DATA_UAV_UAS" predicate="eq">FLYING</channel>
          <channel name="FAA_COLLISION" predicate="ne">COLLISION</channel>
          <channel name="RADAR_COLLISION" predicate="ne">RADAR_COLLISION</channel>
        </inputs>
        <outputs>
          <channel name="FAA_COLLISION">COLLISION</channel>
        </outputs>
      </transition>
    </event>
    
    <!--Match this count to the FAA_COLLISION count-->
    <event name="END_UAV_COLLISION" count="1" >
      <transition>
        <description>End the FAA potential collision with a UAV</description>
        <inputs>
          <channel name="VISUAL_FAA_ATC">
            <layer name="RADAR" predicate="eq">COLLISION</layer>
          </channel>
          <channel name="DATA_UAV_UAS" predicate="eq">LOITER</channel>
        </inputs>
        <outputs>
          <channel name="END_UAV_COLLISION">END_UAV_COLLISION</channel>
        </outputs>
      </transition>
    </event>
    
    <event name="NEW_NOTAM" count="1">
      <transition>
        <description>Request that ATC create a new NOTAM on UAV FP</description>
        <inputs>
          <channel name="DATA_ATC_STATE" predicate="eq">NORMAL</channel>
          <channel name="NEW_NOTAM" predicate="eq"><null/></channel>
          <channel name="DATA_UAV_UAS" predicate="eq">FLYING</channel>
        </inputs>
        <outputs>
          <channel name="NEW_NOTAM">NEW_NOTAM</channel>
        </outputs>
      </transition>
    </event>
  </events>
</team>

